<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>lcsm: An R Package for Latent Change Score Modeling • lcsm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="lcsm: An R Package for Latent Change Score Modeling">
<meta property="og:description" content="Helper functions to implement univariate and bivariate latent change score models (LCSM) in R using the lavaan package.
  The package generates lavaan syntax for different model specifications and varying timepoints.
  The lavaan syntax generated by the package can be returned and further specifications can be added manually.
  Longitudinal plots as well as simplified path diagrams can be created to visualise data and model specifications.
  Longitudinal plots help to visualise data and simplified path diagrams illustrate the selected model specifications.
  Estimated model parameters and fit statistics can be extracted as dataframes.
  Data for different univariate and bivariate LCSM can be simulated by specifying estimates for model parameters to explore the effects of different parameters.
  This package combines the strengths of other R packages like lavaan, broom, and semPlot by generating lavaan syntax that helps these packages work together.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lcsm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="lcsm-an-r-package-for-latent-change-score-modeling" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lcsm-an-r-package-for-latent-change-score-modeling" class="anchor"></a>lcsm: An R Package for Latent Change Score Modeling</h1></div>

<p>This package offers some helper functions to specify and analyse univariate and bivariate latent change score models (LCSM) using <a href="http://lavaan.ugent.be/">lavaan</a> (Rosseel, <a href="http://www.jstatsoft.org/v48/i02/">2012</a>). For details about this method see for example McArdle (<a href="http://www.annualreviews.org/doi/10.1146/annurev.psych.60.110707.163612">2009</a>), Ghisletta (<a href="https://doi.org/10.1080/10705511.2012.713275">2012</a>), Grimm et al. (<a href="https://doi.org/10.1080/10705511.2012.659627">2012</a>), and Grimm, Ram &amp; Estabrook (<a href="https://www.guilford.com/books/Growth-Modeling/Grimm-Ram-Estabrook/9781462526062">2017</a>).</p>
<p>I started working on this project to better understand how latent change score modeling works. This package combines the strengths of other R packages like <a href="http://lavaan.ugent.be/">lavaan</a>, <a href="https://broom.tidyverse.org">broom</a>, and <a href="https://cran.r-project.org/web/packages/semPlot/index.html">semPlot</a> by generating lavaan syntax that helps these packages work together.</p>
<p>An interactive web application <strong><a href="https://milanwiedemann.shinyapps.io/shinychange"><code>shinychange</code></a></strong> illustrates some functions of this package. This is work in progress and feedback is very welcome!</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version from <a href="https://github.com/milanwiedemann/lcsm">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"milanwiedemann/lcsm"</span>)</a></code></pre></div>
</div>
<div id="overview-of-the-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-the-functions" class="anchor"></a>Overview of the functions</h2>
<p>The <code>lcsm</code> package contains the following functions that can be categorised into:</p>
<ul>
<li>Functions to generate <a href="http://lavaan.ugent.be/">lavaan</a> syntax for different model specifications:
<ul>
<li>
<code><a href="reference/specify_uni_lcsm.html">specify_uni_lcsm()</a></code>: Generate syntax for univariate LCSM</li>
<li>
<code><a href="reference/specify_bi_lcsm.html">specify_bi_lcsm()</a></code>: Generate syntax for bivariate LCSM</li>
</ul>
</li>
<li>Functions to fit models using <a href="http://lavaan.ugent.be/">lavaan</a>:
<ul>
<li>
<code><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm()</a></code>: Fit univariate LCSM</li>
<li>
<code><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm()</a></code>: Fit bivariate LCSM</li>
</ul>
</li>
<li>Functions to extract results from models using <a href="https://broom.tidyverse.org/">broom</a>:
<ul>
<li>
<code><a href="reference/extract_fit.html">extract_fit()</a></code>: Extract fit statistics</li>
<li>
<code><a href="reference/extract_param.html">extract_param()</a></code>: Extract estimated parameters</li>
</ul>
</li>
<li>Simulate data using <a href="http://lavaan.ugent.be/">lavaan</a>:
<ul>
<li>
<code><a href="reference/sim_uni_lcsm.html">sim_uni_lcsm()</a></code>: Simulate data by specifying parameters for a univariate LCSM</li>
<li>
<code><a href="reference/sim_bi_lcsm.html">sim_bi_lcsm()</a></code>: Simulate data by specifying parameters for a bivariate LCSM</li>
</ul>
</li>
<li>Helper functions:
<ul>
<li>
<code><a href="reference/plot_lcsm.html">plot_lcsm()</a></code>: Visualise LCSM using <a href="http://sachaepskamp.com/semPlot">semPlot</a>
</li>
<li>
<code><a href="reference/select_uni_cases.html">select_uni_cases()</a></code>: Select cases for analysis based on available scores on one construct</li>
<li>
<code><a href="reference/select_bi_cases.html">select_bi_cases()</a></code>: Select cases for analysis based on available scores on two construct</li>
</ul>
</li>
</ul>
</div>
<div id="how-to-use-lcsm" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-use-lcsm" class="anchor"></a>How to use <code>lcsm</code>
</h2>
<p>Here are a few examples how to use the <code>lcsm</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Load the package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lcsm)</a></code></pre></div>
<div id="visualise-data" class="section level3">
<h3 class="hasAnchor">
<a href="#visualise-data" class="anchor"></a>Visualise data</h3>
<p>Longitudinal data can be visualised using the <code><a href="reference/plot_trajectories.html">plot_trajectories()</a></code> function. Here only 30% of the data is visualised using the argument <code>random_sample_frac = 0.3</code>. Only consecutive measures are connected by lines as specified in <code>connect_missing = FALSE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Create plot for construct x</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">plot_x &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_trajectories.html">plot_trajectories</a></span>(<span class="dt">data =</span> data_bi_lcsm,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                            <span class="dt">id_var =</span> <span class="st">"id"</span>, </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                            <span class="dt">var_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>, </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                                         <span class="st">"x6"</span>, <span class="st">"x7"</span>, <span class="st">"x8"</span>, <span class="st">"x9"</span>, <span class="st">"x10"</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                            <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"X Score"</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                            <span class="dt">connect_missing =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                            <span class="dt">random_sample_frac =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co"># Create plot for construct y</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">plot_y &lt;-<span class="st"> </span><span class="kw"><a href="reference/plot_trajectories.html">plot_trajectories</a></span>(<span class="dt">data =</span> data_bi_lcsm,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">                            <span class="dt">id_var =</span> <span class="st">"id"</span>, </a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                            <span class="dt">var_list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, </a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                                        <span class="st">"y6"</span>, <span class="st">"y7"</span>, <span class="st">"y8"</span>, <span class="st">"y9"</span>, <span class="st">"y10"</span>),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                            <span class="dt">xlab =</span> <span class="st">"Time"</span>, <span class="dt">ylab =</span> <span class="st">"Y Score"</span>,</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                            <span class="dt">connect_missing =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb3-17" data-line-number="17">                            <span class="dt">random_sample_frac =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co"># Arrange plots next to each other using ggpubr::ggarrange()</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">ggpubr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ggpubr/man/ggarrange.html">ggarrange</a></span>(plot_x,</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">                  plot_y,</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">                  <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; Warning: Removed 13 rows containing missing values (geom_path).</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; Warning: Removed 75 rows containing missing values (geom_point).</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; Warning: Removed 35 rows containing missing values (geom_path).</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; Warning: Removed 169 rows containing missing values (geom_point).</span></a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div id="fit-lcs-models" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-lcs-models" class="anchor"></a>Fit LCS models</h3>
<p>In a first step the functions <code><a href="reference/specify_uni_lcsm.html">specify_uni_lcsm()</a></code> and <code><a href="reference/specify_bi_lcsm.html">specify_bi_lcsm()</a></code> are used to specify the lavaan syntax for a specific LCS model. The functions <code><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm()</a></code> and <code><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm()</a></code> are running specifying the syntax before passing it on to lavaan.</p>
<p>The following table descibes some of the different model specifications that the <code>model</code> arguments can take. More detail can be found in the help files <code><a href="https://rdrr.io/r/utils/help.html">help(fit_uni_lcsm)</a></code>.</p>
<div id="fit-univariate-lcs-models" class="section level4">
<h4 class="hasAnchor">
<a href="#fit-univariate-lcs-models" class="anchor"></a>Fit univariate LCS models</h4>
<table class="table">
<thead><tr class="header">
<th align="left">Model specification</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">alpha_constant</td>
<td align="left">Constant change factor</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="left">Proportional change factor</td>
</tr>
<tr class="odd">
<td align="left">phi</td>
<td align="left">Autoregression of change scores</td>
</tr>
</tbody>
</table>
<p>The example below shows how to specify a generic univariate latent change score model using the function <code><a href="reference/specify_uni_lcsm.html">specify_uni_lcsm()</a></code>. A table of the description of all parameters that can be estimated is shown <a href="#overview-of-estimated-lcs-model-parameters">here</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="reference/specify_uni_lcsm.html">specify_uni_lcsm</a></span>(<span class="dt">timepoints =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                 <span class="dt">var =</span> <span class="st">"x"</span>,  </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                 <span class="dt">change_letter =</span> <span class="st">"g"</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                 <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                              <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                              <span class="dt">phi =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<details><summary>Click here to see the <code>lavaan</code> syntax specified
above.</summary><p>

    # Specify latent true scores 
    lx1 =~ 1 * x1 
    lx2 =~ 1 * x2 
    lx3 =~ 1 * x3 
    lx4 =~ 1 * x4 
    lx5 =~ 1 * x5 
    # Specify mean of latent true scores 
    lx1 ~ gamma_lx1 * 1 
    lx2 ~ 0 * 1 
    lx3 ~ 0 * 1 
    lx4 ~ 0 * 1 
    lx5 ~ 0 * 1 
    # Specify variance of latent true scores 
    lx1 ~~ sigma2_lx1 * lx1 
    lx2 ~~ 0 * lx2 
    lx3 ~~ 0 * lx3 
    lx4 ~~ 0 * lx4 
    lx5 ~~ 0 * lx5 
    # Specify intercept of obseved scores 
    x1 ~ 0 * 1 
    x2 ~ 0 * 1 
    x3 ~ 0 * 1 
    x4 ~ 0 * 1 
    x5 ~ 0 * 1 
    # Specify variance of observed scores 
    x1 ~~ sigma2_ux * x1 
    x2 ~~ sigma2_ux * x2 
    x3 ~~ sigma2_ux * x3 
    x4 ~~ sigma2_ux * x4 
    x5 ~~ sigma2_ux * x5 
    # Specify autoregressions of latent variables 
    lx2 ~ 1 * lx1 
    lx3 ~ 1 * lx2 
    lx4 ~ 1 * lx3 
    lx5 ~ 1 * lx4 
    # Specify latent change scores 
    dx2 =~ 1 * lx2 
    dx3 =~ 1 * lx3 
    dx4 =~ 1 * lx4 
    dx5 =~ 1 * lx5 
    # Specify latent change scores means 
    dx2 ~ 0 * 1 
    dx3 ~ 0 * 1 
    dx4 ~ 0 * 1 
    dx5 ~ 0 * 1 
    # Specify latent change scores variances 
    dx2 ~~ 0 * dx2 
    dx3 ~~ 0 * dx3 
    dx4 ~~ 0 * dx4 
    dx5 ~~ 0 * dx5 
    # Specify constant change factor 
    g2 =~ 1 * dx2 + 1 * dx3 + 1 * dx4 + 1 * dx5 
    # Specify constant change factor mean 
    g2 ~ alpha_g2 * 1 
    # Specify constant change factor variance 
    g2 ~~ sigma2_g2 * g2 
    # Specify constant change factor covariance with the initial true score 
    g2 ~~ sigma_g2lx1 * lx1
    # Specify proportional change component 
    dx2 ~ beta_x * lx1 
    dx3 ~ beta_x * lx2 
    dx4 ~ beta_x * lx3 
    dx5 ~ beta_x * lx4 
    # Specify autoregression of change score 
    dx3 ~ phi_x * dx2 
    dx4 ~ phi_x * dx3 
    dx5 ~ phi_x * dx4 

</p>

</details><p>The function <code><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm()</a></code> can be used to fit a univariate LCS model using the sample data set <code>data_uni_lcsm</code>. This functions first writes the lavaan syntax specified in the <code>model</code> argument and passes it on to <code>lavaaan::lavaan()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Fit univariate latent change score model</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm</a></span>(<span class="dt">data =</span> data_uni_lcsm, </a>
<a class="sourceLine" id="cb5-3" data-line-number="3">             <span class="dt">var =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                      <span class="st">"x6"</span>, <span class="st">"x7"</span>, <span class="st">"x8"</span>, <span class="st">"x9"</span>, <span class="st">"x10"</span>),</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">             <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb5-6" data-line-number="6">                          <span class="dt">beta =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb5-7" data-line-number="7">                          <span class="dt">phi =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; lavaan 0.6-5 ended normally after 66 iterations</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;   Estimator                                         ML</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;   Optimization method                           NLMINB</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   Number of free parameters                         23</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;   Number of equality constraints                    16</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;   Row rank of the constraints matrix                16</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;                                                       </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;   Number of observations                           500</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;   Number of missing patterns                       273</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;                                                       </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; Model Test User Model:</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;                                               Standard      Robust</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt;   Test Statistic                                75.389      74.400</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt;   Degrees of freedom                                58          58</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt;   P-value (Chi-square)                           0.062       0.072</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt;   Scaling correction factor                                  1.013</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt;     for the Yuan-Bentler correction (Mplus variant)</span></a></code></pre></div>
<p>It is also possible to show the lavaan syntax that was created to fit the model by the function <code><a href="reference/specify_uni_lcsm.html">specify_uni_lcsm()</a></code>. The lavaan syntax includes comments describing some parts of the syntax in more detail. To save the syntax in an object the argument <code>return_lavaan_syntax_string</code> has to be set to <code>TRUE</code>. This object can be returned in an easy to read format using <code><a href="https://rdrr.io/r/base/cat.html">cat(syntax)</a></code>, or as a simple string without the <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Fit univariate latent change score model</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">syntax &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm</a></span>(<span class="dt">data =</span> data_uni_lcsm, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                       <span class="dt">var =</span>  <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                                <span class="st">"x6"</span>, <span class="st">"x7"</span>, <span class="st">"x8"</span>, <span class="st">"x9"</span>, <span class="st">"x10"</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                       <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                                    <span class="dt">beta =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">                                    <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                      <span class="dt">return_lavaan_syntax =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                      <span class="dt">return_lavaan_syntax_string =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co"># Return lavaan syntax in easy to read format</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(syntax)</a></code></pre></div>
<details><summary>Click here to see the lavaan syntax specified in
<code>syntax</code>.</summary><p>

    # Specify latent true scores 
    lx1 =~ 1 * x1 
    lx2 =~ 1 * x2 
    lx3 =~ 1 * x3 
    lx4 =~ 1 * x4 
    lx5 =~ 1 * x5 
    lx6 =~ 1 * x6 
    lx7 =~ 1 * x7 
    lx8 =~ 1 * x8 
    lx9 =~ 1 * x9 
    lx10 =~ 1 * x10 
    # Specify mean of latent true scores 
    lx1 ~ gamma_lx1 * 1 
    lx2 ~ 0 * 1 
    lx3 ~ 0 * 1 
    lx4 ~ 0 * 1 
    lx5 ~ 0 * 1 
    lx6 ~ 0 * 1 
    lx7 ~ 0 * 1 
    lx8 ~ 0 * 1 
    lx9 ~ 0 * 1 
    lx10 ~ 0 * 1 
    # Specify variance of latent true scores 
    lx1 ~~ sigma2_lx1 * lx1 
    lx2 ~~ 0 * lx2 
    lx3 ~~ 0 * lx3 
    lx4 ~~ 0 * lx4 
    lx5 ~~ 0 * lx5 
    lx6 ~~ 0 * lx6 
    lx7 ~~ 0 * lx7 
    lx8 ~~ 0 * lx8 
    lx9 ~~ 0 * lx9 
    lx10 ~~ 0 * lx10 
    # Specify intercept of obseved scores 
    x1 ~ 0 * 1 
    x2 ~ 0 * 1 
    x3 ~ 0 * 1 
    x4 ~ 0 * 1 
    x5 ~ 0 * 1 
    x6 ~ 0 * 1 
    x7 ~ 0 * 1 
    x8 ~ 0 * 1 
    x9 ~ 0 * 1 
    x10 ~ 0 * 1 
    # Specify variance of observed scores 
    x1 ~~ sigma2_ux * x1 
    x2 ~~ sigma2_ux * x2 
    x3 ~~ sigma2_ux * x3 
    x4 ~~ sigma2_ux * x4 
    x5 ~~ sigma2_ux * x5 
    x6 ~~ sigma2_ux * x6 
    x7 ~~ sigma2_ux * x7 
    x8 ~~ sigma2_ux * x8 
    x9 ~~ sigma2_ux * x9 
    x10 ~~ sigma2_ux * x10 
    # Specify autoregressions of latent variables 
    lx2 ~ 1 * lx1 
    lx3 ~ 1 * lx2 
    lx4 ~ 1 * lx3 
    lx5 ~ 1 * lx4 
    lx6 ~ 1 * lx5 
    lx7 ~ 1 * lx6 
    lx8 ~ 1 * lx7 
    lx9 ~ 1 * lx8 
    lx10 ~ 1 * lx9 
    # Specify latent change scores 
    dx2 =~ 1 * lx2 
    dx3 =~ 1 * lx3 
    dx4 =~ 1 * lx4 
    dx5 =~ 1 * lx5 
    dx6 =~ 1 * lx6 
    dx7 =~ 1 * lx7 
    dx8 =~ 1 * lx8 
    dx9 =~ 1 * lx9 
    dx10 =~ 1 * lx10 
    # Specify latent change scores means 
    dx2 ~ 0 * 1 
    dx3 ~ 0 * 1 
    dx4 ~ 0 * 1 
    dx5 ~ 0 * 1 
    dx6 ~ 0 * 1 
    dx7 ~ 0 * 1 
    dx8 ~ 0 * 1 
    dx9 ~ 0 * 1 
    dx10 ~ 0 * 1 
    # Specify latent change scores variances 
    dx2 ~~ 0 * dx2 
    dx3 ~~ 0 * dx3 
    dx4 ~~ 0 * dx4 
    dx5 ~~ 0 * dx5 
    dx6 ~~ 0 * dx6 
    dx7 ~~ 0 * dx7 
    dx8 ~~ 0 * dx8 
    dx9 ~~ 0 * dx9 
    dx10 ~~ 0 * dx10 
    # Specify constant change factor 
    g2 =~ 1 * dx2 + 1 * dx3 + 1 * dx4 + 1 * dx5 + 1 * dx6 + 1 * dx7 + 1 * dx8 + 1 * dx9 + 1 * dx10 
    # Specify constant change factor mean 
    g2 ~ alpha_g2 * 1 
    # Specify constant change factor variance 
    g2 ~~ sigma2_g2 * g2 
    # Specify constant change factor covariance with the initial true score 
    g2 ~~ sigma_g2lx1 * lx1
    # Specify autoregression of change score 
    dx3 ~ phi_x * dx2 
    dx4 ~ phi_x * dx3 
    dx5 ~ phi_x * dx4 
    dx6 ~ phi_x * dx5 
    dx7 ~ phi_x * dx6 
    dx8 ~ phi_x * dx7 
    dx9 ~ phi_x * dx8 
    dx10 ~ phi_x * dx9 

</p>

</details>
</div>
<div id="fit-bivariate-lcs-models" class="section level4">
<h4 class="hasAnchor">
<a href="#fit-bivariate-lcs-models" class="anchor"></a>Fit bivariate LCS models</h4>
<p>The function <code><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm()</a></code> allowes to specify two univariate LCS models using the arguments <code>model_x</code> and <code>model_x</code>. These two constructs can then be connected using the <code>coupling</code> argument. More details can be found in the help files <code><a href="https://rdrr.io/r/utils/help.html">help(fit_bi_lcsm)</a></code>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Coupling specification</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">coupling_piecewise</td>
<td align="left">Piecewise coupling parameters</td>
</tr>
<tr class="even">
<td align="left">coupling_piecewise_num</td>
<td align="left">Changepoint of piecewise coupling parameters</td>
</tr>
<tr class="odd">
<td align="left">delta_con_xy</td>
<td align="left">Change score x (t) determined by true score y (t)</td>
</tr>
<tr class="even">
<td align="left">delta_con_yx</td>
<td align="left">Change score y (t) determined by true score x (t)</td>
</tr>
<tr class="odd">
<td align="left">delta_lag_xy</td>
<td align="left">Change score x (t) determined by true score y (t-1)</td>
</tr>
<tr class="even">
<td align="left">delta_lag_yx</td>
<td align="left">Change score y (t) determined by true score x (t-1)</td>
</tr>
<tr class="odd">
<td align="left">xi_con_xy</td>
<td align="left">Change score x (t) determined by change score y (t)</td>
</tr>
<tr class="even">
<td align="left">xi_con_yx</td>
<td align="left">Change score y (t) determined by change score x (t)</td>
</tr>
<tr class="odd">
<td align="left">xi_lag_xy</td>
<td align="left">Change score x (t) determined by change score y (t-1)</td>
</tr>
<tr class="even">
<td align="left">xi_lag_yx</td>
<td align="left">Change score y (t) determined by change score x (t-1)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm</a></span>(<span class="dt">data =</span> data_bi_lcsm, </a>
<a class="sourceLine" id="cb7-2" data-line-number="2">            <span class="dt">var_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                      <span class="st">"x6"</span>, <span class="st">"x7"</span>, <span class="st">"x8"</span>, <span class="st">"x9"</span>, <span class="st">"x10"</span>),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">            <span class="dt">var_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, </a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                      <span class="st">"y6"</span>, <span class="st">"y7"</span>, <span class="st">"y8"</span>, <span class="st">"y9"</span>, <span class="st">"y10"</span>),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">            <span class="dt">model_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                           <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                           <span class="dt">phi =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">            <span class="dt">model_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-10" data-line-number="10">                           <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-11" data-line-number="11">                           <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">            <span class="dt">coupling =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">delta_lag_xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-13" data-line-number="13">                            <span class="dt">xi_lag_yx =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; lavaan 0.6-5 ended normally after 118 iterations</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt;   Estimator                                         ML</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt;   Optimization method                           NLMINB</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt;   Number of free parameters                         87</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt;   Number of equality constraints                    65</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt;   Row rank of the constraints matrix                65</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt;                                                       </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt;   Number of observations                           500</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt;   Number of missing patterns                       210</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt;                                                       </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; Model Test User Model:</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;                                               Standard      Robust</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt;   Test Statistic                               191.851     193.021</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;   Degrees of freedom                               208         208</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;   P-value (Chi-square)                           0.782       0.764</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;   Scaling correction factor                                  0.994</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;     for the Yuan-Bentler correction (Mplus variant)</span></a></code></pre></div>
</div>
</div>
<div id="extract-fit-statistics-and-parmeters" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-fit-statistics-and-parmeters" class="anchor"></a>Extract fit statistics and parmeters</h3>
<p>The main underlying functions to extract parameters and fit statistics come from the <code>broom</code> package: <code><a href="https://rdrr.io/pkg/broom/man/reexports.html">broom::tidy()</a></code> and <code><a href="https://rdrr.io/pkg/broom/man/reexports.html">broom::glance()</a></code>. The functions <code><a href="reference/extract_param.html">extract_param()</a></code> and <code><a href="reference/extract_fit.html">extract_fit()</a></code> offer some tools that I find helpful when running LCS models in R, for example:</p>
<ul>
<li>
<code><a href="reference/extract_param.html">extract_param()</a></code>: only one row per estimated parameter,</li>
<li>
<code><a href="reference/extract_fit.html">extract_fit()</a></code>: fit statistics for multiple lavaan objects can be extracted.</li>
</ul>
<p>A table of the description of all parameters that can be estimated is shown <a href="#overview-of-estimated-lcs-model-parameters">here</a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># First create a lavaan object</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">bi_lcsm_<span class="dv">01</span> &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm</a></span>(<span class="dt">data =</span> data_bi_lcsm, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                          <span class="dt">var_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                                    <span class="st">"x6"</span>, <span class="st">"x7"</span>, <span class="st">"x8"</span>, <span class="st">"x9"</span>, <span class="st">"x10"</span>),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                          <span class="dt">var_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>, </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                                    <span class="st">"y6"</span>, <span class="st">"y7"</span>, <span class="st">"y8"</span>, <span class="st">"y9"</span>, <span class="st">"y10"</span>),</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                          <span class="dt">model_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                                         <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                                         <span class="dt">phi =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">                          <span class="dt">model_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb8-11" data-line-number="11">                                         <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb8-12" data-line-number="12">                                         <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">                          <span class="dt">coupling =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">delta_lag_xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb8-14" data-line-number="14">                                          <span class="dt">xi_lag_yx =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb8-15" data-line-number="15"></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co"># Now extract parameter estimates</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co"># Only extract first 7 columns for this example by adding [ , 1:7]</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18">param_bi_lcsm_<span class="dv">01</span> &lt;-<span class="st"> </span><span class="kw"><a href="reference/extract_param.html">extract_param</a></span>(bi_lcsm_<span class="dv">01</span>)[ , <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]</a>
<a class="sourceLine" id="cb8-19" data-line-number="19"></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co"># Print table of parameter estimates</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="kw">kable</span>(param_bi_lcsm_<span class="dv">01</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">label</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gamma_lx1</td>
<td align="right">21.066</td>
<td align="right">0.036</td>
<td align="right">588.187</td>
<td align="right">0.000</td>
<td align="right">20.996</td>
<td align="right">21.136</td>
</tr>
<tr class="even">
<td align="left">sigma2_lx1</td>
<td align="right">0.493</td>
<td align="right">0.037</td>
<td align="right">13.485</td>
<td align="right">0.000</td>
<td align="right">0.421</td>
<td align="right">0.564</td>
</tr>
<tr class="odd">
<td align="left">sigma2_ux</td>
<td align="right">0.201</td>
<td align="right">0.004</td>
<td align="right">45.301</td>
<td align="right">0.000</td>
<td align="right">0.192</td>
<td align="right">0.210</td>
</tr>
<tr class="even">
<td align="left">alpha_g2</td>
<td align="right">-0.309</td>
<td align="right">0.053</td>
<td align="right">-5.834</td>
<td align="right">0.000</td>
<td align="right">-0.413</td>
<td align="right">-0.205</td>
</tr>
<tr class="odd">
<td align="left">sigma2_g2</td>
<td align="right">0.395</td>
<td align="right">0.028</td>
<td align="right">14.330</td>
<td align="right">0.000</td>
<td align="right">0.341</td>
<td align="right">0.449</td>
</tr>
<tr class="even">
<td align="left">sigma_g2lx1</td>
<td align="right">0.155</td>
<td align="right">0.022</td>
<td align="right">7.017</td>
<td align="right">0.000</td>
<td align="right">0.112</td>
<td align="right">0.198</td>
</tr>
<tr class="odd">
<td align="left">beta_x</td>
<td align="right">-0.106</td>
<td align="right">0.003</td>
<td align="right">-30.818</td>
<td align="right">0.000</td>
<td align="right">-0.113</td>
<td align="right">-0.099</td>
</tr>
<tr class="even">
<td align="left">gamma_ly1</td>
<td align="right">5.025</td>
<td align="right">0.029</td>
<td align="right">172.786</td>
<td align="right">0.000</td>
<td align="right">4.968</td>
<td align="right">5.082</td>
</tr>
<tr class="odd">
<td align="left">sigma2_ly1</td>
<td align="right">0.208</td>
<td align="right">0.019</td>
<td align="right">10.860</td>
<td align="right">0.000</td>
<td align="right">0.171</td>
<td align="right">0.246</td>
</tr>
<tr class="even">
<td align="left">sigma2_uy</td>
<td align="right">0.193</td>
<td align="right">0.005</td>
<td align="right">39.698</td>
<td align="right">0.000</td>
<td align="right">0.183</td>
<td align="right">0.202</td>
</tr>
<tr class="odd">
<td align="left">alpha_j2</td>
<td align="right">-0.203</td>
<td align="right">0.039</td>
<td align="right">-5.217</td>
<td align="right">0.000</td>
<td align="right">-0.279</td>
<td align="right">-0.127</td>
</tr>
<tr class="even">
<td align="left">sigma2_j2</td>
<td align="right">0.093</td>
<td align="right">0.008</td>
<td align="right">11.766</td>
<td align="right">0.000</td>
<td align="right">0.077</td>
<td align="right">0.108</td>
</tr>
<tr class="odd">
<td align="left">sigma_j2ly1</td>
<td align="right">0.017</td>
<td align="right">0.008</td>
<td align="right">2.156</td>
<td align="right">0.031</td>
<td align="right">0.002</td>
<td align="right">0.032</td>
</tr>
<tr class="even">
<td align="left">beta_y</td>
<td align="right">-0.197</td>
<td align="right">0.005</td>
<td align="right">-39.562</td>
<td align="right">0.000</td>
<td align="right">-0.207</td>
<td align="right">-0.187</td>
</tr>
<tr class="odd">
<td align="left">phi_y</td>
<td align="right">0.144</td>
<td align="right">0.029</td>
<td align="right">4.963</td>
<td align="right">0.000</td>
<td align="right">0.087</td>
<td align="right">0.201</td>
</tr>
<tr class="even">
<td align="left">sigma_su</td>
<td align="right">0.009</td>
<td align="right">0.003</td>
<td align="right">2.581</td>
<td align="right">0.010</td>
<td align="right">0.002</td>
<td align="right">0.015</td>
</tr>
<tr class="odd">
<td align="left">sigma_ly1lx1</td>
<td align="right">0.185</td>
<td align="right">0.021</td>
<td align="right">8.905</td>
<td align="right">0.000</td>
<td align="right">0.144</td>
<td align="right">0.225</td>
</tr>
<tr class="even">
<td align="left">sigma_g2ly1</td>
<td align="right">0.072</td>
<td align="right">0.016</td>
<td align="right">4.437</td>
<td align="right">0.000</td>
<td align="right">0.040</td>
<td align="right">0.104</td>
</tr>
<tr class="odd">
<td align="left">sigma_j2lx1</td>
<td align="right">0.093</td>
<td align="right">0.012</td>
<td align="right">7.916</td>
<td align="right">0.000</td>
<td align="right">0.070</td>
<td align="right">0.117</td>
</tr>
<tr class="even">
<td align="left">sigma_j2g2</td>
<td align="right">0.005</td>
<td align="right">0.012</td>
<td align="right">0.463</td>
<td align="right">0.643</td>
<td align="right">-0.018</td>
<td align="right">0.029</td>
</tr>
<tr class="odd">
<td align="left">delta_lag_xy</td>
<td align="right">0.140</td>
<td align="right">0.006</td>
<td align="right">23.837</td>
<td align="right">0.000</td>
<td align="right">0.128</td>
<td align="right">0.152</td>
</tr>
<tr class="even">
<td align="left">xi_lag_yx</td>
<td align="right">0.360</td>
<td align="right">0.037</td>
<td align="right">9.634</td>
<td align="right">0.000</td>
<td align="right">0.287</td>
<td align="right">0.433</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-simplified-path-diagrams-of-lcs-models" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-simplified-path-diagrams-of-lcs-models" class="anchor"></a>Plot simplified path diagrams of LCS models</h3>
<p>This function is work in progress and can only plot univariate and bivariate LCS models that were specified with <code><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm()</a></code> or <code><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm()</a></code>. Modified LCS models will probably return errors as the layout matrix that gets created by this plot function only supports the specifications that can be modelled with this package. The input arguments for plotting a simplified path dioagram are:</p>
<ul>
<li>the estimated lavaan object <code>lavaan_object</code>,</li>
<li>the <code>lavaan_syntax</code> and ,</li>
<li>
<code>lcsm</code> indicating whether the LCS model is “univariate” or “bivariate”</li>
</ul>
<p>Optional arguments can be used to change the look of the plot, for example:</p>
<ul>
<li>
<code>lcsm_colours</code> can be used to highlight the different parts of the latent change score model
<ul>
<li>white: observed scores</li>
<li>green: latent true scores</li>
<li>blue: latent change scores</li>
<li>yellow: latent change scores</li>
</ul>
</li>
</ul>
<p>Further arguments can be passed on to <code><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html">semPlot::semPaths()</a></code>, for example:</p>
<ul>
<li>
<code>what</code>, <strong>“path”</strong> to show unweighted gray edges, <strong>“par”</strong> to show parameter estimates as weighted (green/red) edges<br>
</li>
<li>
<code>whatLabels</code>, <strong>“label”</strong> to show edege names as label or <strong>“est”</strong> for parameter estimates, <strong>“hide”</strong> to hide edge labels</li>
</ul>
<div id="univariate-lcs-model" class="section level4">
<h4 class="hasAnchor">
<a href="#univariate-lcs-model" class="anchor"></a>Univariate LCS model</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Fit bivariate lcsm and save the results </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">uni_lavaan_results &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm</a></span>(<span class="dt">data =</span> data_uni_lcsm, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                   <span class="dt">var =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                                   <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                                                <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                                                <span class="dt">phi =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                                  )</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; Warning in lav_data_full(data = data, group = group, cluster = cluster, : lavaan </span><span class="al">WARNING</span><span class="co">: some cases are empty and will be ignored:</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;   239</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co"># Save the lavaan syntax that is used to create the layout matrix for semPlot</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">uni_lavaan_syntax &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_uni_lcsm.html">fit_uni_lcsm</a></span>(<span class="dt">data =</span> data_uni_lcsm, </a>
<a class="sourceLine" id="cb9-13" data-line-number="13">                                  <span class="dt">var =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>),</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">                                  <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-15" data-line-number="15">                                               <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-16" data-line-number="16">                                               <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">                                  <span class="dt">return_lavaan_syntax =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-18" data-line-number="18">                                  <span class="dt">return_lavaan_syntax_string =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-19" data-line-number="19"></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co"># Plot the results</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="kw"><a href="reference/plot_lcsm.html">plot_lcsm</a></span>(<span class="dt">lavaan_object =</span> uni_lavaan_results, </a>
<a class="sourceLine" id="cb9-22" data-line-number="22">          <span class="dt">lavaan_syntax =</span> uni_lavaan_syntax,</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">          <span class="dt">lcsm_colours =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb9-24" data-line-number="24">          <span class="dt">lcsm =</span> <span class="st">"univariate"</span>)</a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; Registered S3 methods overwritten by 'huge':</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt;   method    from   </span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt;   plot.sim  BDgraph</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt;   print.sim BDgraph</span></a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div id="bivariate-lcs-model" class="section level4">
<h4 class="hasAnchor">
<a href="#bivariate-lcs-model" class="anchor"></a>Bivariate LCS model</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Fit bivariate lcsm and save the results </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">bi_lavaan_results &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm</a></span>(<span class="dt">data =</span> data_bi_lcsm, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                                 <span class="dt">var_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                                 <span class="dt">var_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                                 <span class="dt">model_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                                                <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">                                                <span class="dt">phi =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                                 <span class="dt">model_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-9" data-line-number="9">                                                <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-10" data-line-number="10">                                                <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">                                 <span class="dt">coupling =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">delta_lag_xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-12" data-line-number="12">                                                 <span class="dt">xi_lag_yx =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb10-13" data-line-number="13"></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co"># Save the lavaan syntax that is used to create the layout matrix for semPlot</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15">bi_lavaan_syntax &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit_bi_lcsm.html">fit_bi_lcsm</a></span>(<span class="dt">data =</span> data_bi_lcsm, </a>
<a class="sourceLine" id="cb10-16" data-line-number="16">                                <span class="dt">var_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"x5"</span>),</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">                                <span class="dt">var_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>, <span class="st">"y4"</span>, <span class="st">"y5"</span>),</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">                                <span class="dt">model_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-19" data-line-number="19">                                               <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-20" data-line-number="20">                                               <span class="dt">phi =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">                                <span class="dt">model_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-22" data-line-number="22">                                               <span class="dt">beta =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-23" data-line-number="23">                                               <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb10-24" data-line-number="24">                                <span class="dt">coupling =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">delta_lag_xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-25" data-line-number="25">                                                <span class="dt">xi_lag_yx =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">                                <span class="dt">return_lavaan_syntax =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-27" data-line-number="27">                                <span class="dt">return_lavaan_syntax_string =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-28" data-line-number="28"></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co"># Plot the results</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="kw"><a href="reference/plot_lcsm.html">plot_lcsm</a></span>(<span class="dt">lavaan_object =</span> bi_lavaan_results, </a>
<a class="sourceLine" id="cb10-31" data-line-number="31">          <span class="dt">lavaan_syntax =</span> bi_lavaan_syntax,</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">          <span class="dt">lcsm_colours =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb10-33" data-line-number="33">          <span class="dt">whatLabels =</span> <span class="st">"hide"</span>,</a>
<a class="sourceLine" id="cb10-34" data-line-number="34">          <span class="dt">lcsm =</span> <span class="st">"bivariate"</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
</div>
</div>
<div id="simulate-data" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-data" class="anchor"></a>Simulate data</h3>
<p>The functions <code><a href="reference/sim_uni_lcsm.html">sim_uni_lcsm()</a></code> and <code><a href="reference/sim_bi_lcsm.html">sim_bi_lcsm()</a></code> simulate data based on some some parameters that can be specified. See the tables <a href="#overview-of-estimated-lcs-model-parameters">here</a> for a full list of parameters that can be specified for the data simulation.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Simulate some data </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="reference/sim_uni_lcsm.html">sim_uni_lcsm</a></span>(<span class="dt">timepoints =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">             <span class="dt">model =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, <span class="dt">beta =</span> <span class="ot">FALSE</span>, <span class="dt">phi =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">             <span class="dt">model_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">gamma_lx1 =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">                                <span class="dt">sigma2_lx1 =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">                                <span class="dt">sigma2_ux =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">                                <span class="dt">alpha_j2 =</span> <span class="fl">-0.93</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                                <span class="dt">sigma2_j2 =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                                <span class="dt">sigma_j2lx1 =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">                                <span class="dt">phi_x =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">             <span class="dt">sample.nobs =</span> <span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">             <span class="dt">na_pct =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; Parameter estimates for the data simulation are taken from the argument 'model_param'.</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; Warning: The following parameters are specified in LCS model but no parameter estimates have been entered in 'model_param':</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; -  alpha_g2</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; -  sigma2_g2</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; -  sigma_g2lx1</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; # A tibble: 1,000 x 6</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#&gt;       id    x1    x2    x3    x4    x5</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#&gt;  1     1  20.2  21.8  24.0  26.3  29.0</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#&gt;  2     2  NA    NA    24.3  25.0  26.4</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co">#&gt;  3     3  21.6  NA    NA    21.2  21.0</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co">#&gt;  4     4  NA    20.7  17.5  14.3  NA  </span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#&gt;  5     5  18.8  19.6  18.9  19.2  NA  </span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#&gt;  6     6  18.7  19.5  17.7  NA    NA  </span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#&gt;  7     7  19.9  19.2  18.0  17.4  15.2</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#&gt;  8     8  21.0  22.0  25.0  27.4  29.9</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#&gt;  9     9  NA    19.8  20.2  NA    18.3</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#&gt; 10    10  20.1  20.7  NA    24.7  25.3</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#&gt; # … with 990 more rows</span></a></code></pre></div>
<p>It is also possible to return the lavaan syntax instead of simulating data for further manual specifications. The modified object could then be used to simulate data using <code><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html">lavaan::simulateData()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Return lavaan syntax based on the following argument specifications</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">simsyntax &lt;-<span class="st"> </span><span class="kw"><a href="reference/sim_bi_lcsm.html">sim_bi_lcsm</a></span>(<span class="dt">timepoints =</span> <span class="dv">5</span>, </a>
<a class="sourceLine" id="cb12-3" data-line-number="3">                         <span class="dt">model_x =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, <span class="dt">beta =</span> <span class="ot">TRUE</span>, <span class="dt">phi =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">                         <span class="dt">model_x_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">gamma_lx1 =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">                                              <span class="dt">sigma2_lx1 =</span> <span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">                                              <span class="dt">sigma2_ux =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">                                              <span class="dt">alpha_g2 =</span> <span class="fl">-.4</span>,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">                                              <span class="dt">sigma2_g2 =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">                                              <span class="dt">sigma_g2lx1 =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">                                              <span class="dt">beta_x =</span> <span class="fl">-.1</span>),</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">                         <span class="dt">model_y =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">alpha_constant =</span> <span class="ot">TRUE</span>, <span class="dt">beta =</span> <span class="ot">TRUE</span>, <span class="dt">phi =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">                         <span class="dt">model_y_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">gamma_ly1 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">                                              <span class="dt">sigma2_ly1 =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">                                              <span class="dt">sigma2_uy =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">                                              <span class="dt">alpha_j2 =</span> <span class="fl">-.2</span>,</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">                                              <span class="dt">sigma2_j2 =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">                                              <span class="dt">sigma_j2ly1 =</span> <span class="fl">.02</span>,</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">                                              <span class="dt">beta_y =</span> <span class="fl">-.2</span>,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">                                              <span class="dt">phi_y =</span> <span class="fl">.1</span>),</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">                         <span class="dt">coupling =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">delta_lag_xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb12-21" data-line-number="21">                                         <span class="dt">xi_lag_yx =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">                         <span class="dt">coupling_param =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">sigma_su =</span> <span class="fl">.01</span>,</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">                                               <span class="dt">sigma_ly1lx1 =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">                                               <span class="dt">sigma_g2ly1 =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">                                               <span class="dt">sigma_j2lx1 =</span> <span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">                                               <span class="dt">sigma_j2g2 =</span> <span class="fl">.01</span>,</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">                                               <span class="dt">delta_lag_xy =</span> <span class="fl">.13</span>,</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">                                               <span class="dt">xi_lag_yx =</span> <span class="fl">.4</span>),</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">                         <span class="dt">return_lavaan_syntax =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<details><summary>Click here to see the lavaan syntax specified in
<code>simsyntax</code>.</summary><p>

    # Specify parameters for construct x ----
    # Specify latent true scores 
    lx1 =~ 1 * x1 
    lx2 =~ 1 * x2 
    lx3 =~ 1 * x3 
    lx4 =~ 1 * x4 
    lx5 =~ 1 * x5 
    # Specify mean of latent true scores 
    lx1 ~ 21 * 1 
    lx2 ~ 0 * 1 
    lx3 ~ 0 * 1 
    lx4 ~ 0 * 1 
    lx5 ~ 0 * 1 
    # Specify variance of latent true scores 
    lx1 ~~ 0.5 * lx1 
    lx2 ~~ 0 * lx2 
    lx3 ~~ 0 * lx3 
    lx4 ~~ 0 * lx4 
    lx5 ~~ 0 * lx5 
    # Specify intercept of obseved scores 
    x1 ~ 0 * 1 
    x2 ~ 0 * 1 
    x3 ~ 0 * 1 
    x4 ~ 0 * 1 
    x5 ~ 0 * 1 
    # Specify variance of observed scores 
    x1 ~~ 0.2 * x1 
    x2 ~~ 0.2 * x2 
    x3 ~~ 0.2 * x3 
    x4 ~~ 0.2 * x4 
    x5 ~~ 0.2 * x5 
    # Specify autoregressions of latent variables 
    lx2 ~ 1 * lx1 
    lx3 ~ 1 * lx2 
    lx4 ~ 1 * lx3 
    lx5 ~ 1 * lx4 
    # Specify latent change scores 
    dx2 =~ 1 * lx2 
    dx3 =~ 1 * lx3 
    dx4 =~ 1 * lx4 
    dx5 =~ 1 * lx5 
    # Specify latent change scores means 
    dx2 ~ 0 * 1 
    dx3 ~ 0 * 1 
    dx4 ~ 0 * 1 
    dx5 ~ 0 * 1 
    # Specify latent change scores variances 
    dx2 ~~ 0 * dx2 
    dx3 ~~ 0 * dx3 
    dx4 ~~ 0 * dx4 
    dx5 ~~ 0 * dx5 
    # Specify constant change factor 
    g2 =~ 1 * dx2 + 1 * dx3 + 1 * dx4 + 1 * dx5 
    # Specify constant change factor mean 
    g2 ~ -0.4 * 1 
    # Specify constant change factor variance 
    g2 ~~ 0.4 * g2 
    # Specify constant change factor covariance with the initial true score 
    g2 ~~ 0.2 * lx1
    # Specify proportional change component 
    dx2 ~ -0.1 * lx1 
    dx3 ~ -0.1 * lx2 
    dx4 ~ -0.1 * lx3 
    dx5 ~ -0.1 * lx4 
    # Specify parameters for construct y ----
    # Specify latent true scores 
    ly1 =~ 1 * y1 
    ly2 =~ 1 * y2 
    ly3 =~ 1 * y3 
    ly4 =~ 1 * y4 
    ly5 =~ 1 * y5 
    # Specify mean of latent true scores 
    ly1 ~ 5 * 1 
    ly2 ~ 0 * 1 
    ly3 ~ 0 * 1 
    ly4 ~ 0 * 1 
    ly5 ~ 0 * 1 
    # Specify variance of latent true scores 
    ly1 ~~ 0.2 * ly1 
    ly2 ~~ 0 * ly2 
    ly3 ~~ 0 * ly3 
    ly4 ~~ 0 * ly4 
    ly5 ~~ 0 * ly5 
    # Specify intercept of obseved scores 
    y1 ~ 0 * 1 
    y2 ~ 0 * 1 
    y3 ~ 0 * 1 
    y4 ~ 0 * 1 
    y5 ~ 0 * 1 
    # Specify variance of observed scores 
    y1 ~~ 0.2 * y1 
    y2 ~~ 0.2 * y2 
    y3 ~~ 0.2 * y3 
    y4 ~~ 0.2 * y4 
    y5 ~~ 0.2 * y5 
    # Specify autoregressions of latent variables 
    ly2 ~ 1 * ly1 
    ly3 ~ 1 * ly2 
    ly4 ~ 1 * ly3 
    ly5 ~ 1 * ly4 
    # Specify latent change scores 
    dy2 =~ 1 * ly2 
    dy3 =~ 1 * ly3 
    dy4 =~ 1 * ly4 
    dy5 =~ 1 * ly5 
    # Specify latent change scores means 
    dy2 ~ 0 * 1 
    dy3 ~ 0 * 1 
    dy4 ~ 0 * 1 
    dy5 ~ 0 * 1 
    # Specify latent change scores variances 
    dy2 ~~ 0 * dy2 
    dy3 ~~ 0 * dy3 
    dy4 ~~ 0 * dy4 
    dy5 ~~ 0 * dy5 
    # Specify constant change factor 
    j2 =~ 1 * dy2 + 1 * dy3 + 1 * dy4 + 1 * dy5 
    # Specify constant change factor mean 
    j2 ~ -0.2 * 1 
    # Specify constant change factor variance 
    j2 ~~ 0.1 * j2 
    # Specify constant change factor covariance with the initial true score 
    j2 ~~ 0.02 * ly1
    # Specify proportional change component 
    dy2 ~ -0.2 * ly1 
    dy3 ~ -0.2 * ly2 
    dy4 ~ -0.2 * ly3 
    dy5 ~ -0.2 * ly4 
    # Specify autoregression of change score 
    dy3 ~ 0.1 * dy2 
    dy4 ~ 0.1 * dy3 
    dy5 ~ 0.1 * dy4 
    # Specify residual covariances 
    x1 ~~ 0.01 * y1 
    x2 ~~ 0.01 * y2 
    x3 ~~ 0.01 * y3 
    x4 ~~ 0.01 * y4 
    x5 ~~ 0.01 * y5 
    # Specify covariances betweeen specified change components (alpha) and intercepts (initial latent true scores lx1 and ly1) ----
    # Specify covariance of intercepts 
    lx1 ~~ 0.2 * ly1 
    # Specify covariance of constant change and intercept within the same construct 
    ly1 ~~ 0.1 * g2 
    # Specify covariance of constant change and intercept within the same construct 
    lx1 ~~ 0.1 * j2 
    # Specify covariance of constant change factors between constructs 
    g2 ~~ 0.01 * j2 
    # Specify between-construct coupling parameters ----
    # Change score x (t) is determined by true score y (t-1)  
    dx2 ~ 0.13 * ly1 
    dx3 ~ 0.13 * ly2 
    dx4 ~ 0.13 * ly3 
    dx5 ~ 0.13 * ly4 
    # Change score y (t) is determined by change score x (t-1)  
    dy3 ~ 0.4 * dx2 
    dy4 ~ 0.4 * dx3 
    dy5 ~ 0.4 * dx4 

</p>

</details>
</div>
</div>
<div id="overview-of-estimated-lcs-model-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-estimated-lcs-model-parameters" class="anchor"></a>Overview of estimated LCS model parameters</h2>
<div id="univariate-lcs-models" class="section level3">
<h3 class="hasAnchor">
<a href="#univariate-lcs-models" class="anchor"></a>Univariate LCS models</h3>
<p>Depending on the specified model, the following parameters can be estimated for <strong>univariate</strong> LCS models:</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gamma_lx1</td>
<td align="left">Mean of latent true scores x (Intercept)</td>
</tr>
<tr class="even">
<td align="left">sigma2_lx1</td>
<td align="left">Variance of latent true scores x</td>
</tr>
<tr class="odd">
<td align="left">sigma2_ux</td>
<td align="left">Variance of observed scores x</td>
</tr>
<tr class="even">
<td align="left">alpha_g2</td>
<td align="left">Mean of change factor (g2)</td>
</tr>
<tr class="odd">
<td align="left">alpha_g3</td>
<td align="left">Mean of change factor (g3)</td>
</tr>
<tr class="even">
<td align="left">sigma2_g2</td>
<td align="left">Variance of change factor (g2)</td>
</tr>
<tr class="odd">
<td align="left">sigma2_g3</td>
<td align="left">Variance of change factor (g3)</td>
</tr>
<tr class="even">
<td align="left">sigma_g2lx1</td>
<td align="left">Covariance of change factor (g2) with the initial true score x</td>
</tr>
<tr class="odd">
<td align="left">sigma_g3lx1</td>
<td align="left">Covariance of change factor (g3) with the initial true score x</td>
</tr>
<tr class="even">
<td align="left">sigma_g2g3</td>
<td align="left">Covariance of change factors within construct x</td>
</tr>
<tr class="odd">
<td align="left">beta_x</td>
<td align="left">Proportional change x</td>
</tr>
<tr class="even">
<td align="left">phi_x</td>
<td align="left">Autoregression of change scores x</td>
</tr>
</tbody>
</table>
</div>
<div id="bivariate-lcs-models" class="section level3">
<h3 class="hasAnchor">
<a href="#bivariate-lcs-models" class="anchor"></a>Bivariate LCS models</h3>
<p>For bivariate LCS models, estimated parameters can be categorised into</p>
<p>(1) <strong>Construct X</strong>, (2) <strong>Construct Y</strong>, and (3) <strong>Coupling between X and Y</strong>.</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Construct X</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">gamma_lx1</td>
<td align="left">Mean of latent true scores x (Intercept)</td>
</tr>
<tr class="odd">
<td align="left">sigma2_lx1</td>
<td align="left">Variance of latent true scores x</td>
</tr>
<tr class="even">
<td align="left">sigma2_ux</td>
<td align="left">Variance of observed scores x</td>
</tr>
<tr class="odd">
<td align="left">alpha_g2</td>
<td align="left">Mean of change factor (g2)</td>
</tr>
<tr class="even">
<td align="left">alpha_g3</td>
<td align="left">Mean of change factor (g3)</td>
</tr>
<tr class="odd">
<td align="left">sigma2_g2</td>
<td align="left">Variance of change factor (g2)</td>
</tr>
<tr class="even">
<td align="left">sigma2_g3</td>
<td align="left">Variance of change factor (g3)</td>
</tr>
<tr class="odd">
<td align="left">beta_x</td>
<td align="left">Proportional change x</td>
</tr>
<tr class="even">
<td align="left">sigma_g2lx1</td>
<td align="left">Covariance of change factor (g2) with the initial true score x (lx1)</td>
</tr>
<tr class="odd">
<td align="left">sigma_g3lx1</td>
<td align="left">Covariance of change factor (g3) with the initial true score x (lx1)</td>
</tr>
<tr class="even">
<td align="left">sigma_g2g3</td>
<td align="left">Covariance of change factors within construct x</td>
</tr>
<tr class="odd">
<td align="left">phi_x</td>
<td align="left">Autoregression of change scores x</td>
</tr>
<tr class="even">
<td align="left"><strong>Construct Y</strong></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">gamma_ly1</td>
<td align="left">Mean of latent true scores y (Intercept)</td>
</tr>
<tr class="even">
<td align="left">sigma2_ly1</td>
<td align="left">Variance of latent true scores y</td>
</tr>
<tr class="odd">
<td align="left">sigma2_uy</td>
<td align="left">Variance of observed scores y</td>
</tr>
<tr class="even">
<td align="left">alpha_j2</td>
<td align="left">Mean of change factor (j2)</td>
</tr>
<tr class="odd">
<td align="left">alpha_j3</td>
<td align="left">Mean of change factor (j3)</td>
</tr>
<tr class="even">
<td align="left">sigma2_j2</td>
<td align="left">Variance of change factor (j2)</td>
</tr>
<tr class="odd">
<td align="left">sigma2_j3</td>
<td align="left">Variance of change factor (j3)</td>
</tr>
<tr class="even">
<td align="left">beta_y</td>
<td align="left">Proportional change y</td>
</tr>
<tr class="odd">
<td align="left">sigma_j2ly1</td>
<td align="left">Covariance of change factor (j2) with the initial true score y (ly1)</td>
</tr>
<tr class="even">
<td align="left">sigma_j3ly1</td>
<td align="left">Covariance of change factor (j3) with the initial true score y (ly1)</td>
</tr>
<tr class="odd">
<td align="left">sigma_j2j3</td>
<td align="left">Covariance of change factors within construct y</td>
</tr>
<tr class="even">
<td align="left">phi_y</td>
<td align="left">Autoregression of change scores y</td>
</tr>
<tr class="odd">
<td align="left"><strong>Coupeling X &amp; Y</strong></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">sigma_su</td>
<td align="left">Covariance of residuals x and y</td>
</tr>
<tr class="odd">
<td align="left">sigma_ly1lx1</td>
<td align="left">Covariance of intercepts x and y</td>
</tr>
<tr class="even">
<td align="left">sigma_g2ly1</td>
<td align="left">Covariance of change factor x (g2) with the initial true score y (ly1)</td>
</tr>
<tr class="odd">
<td align="left">sigma_g3ly1</td>
<td align="left">Covariance of change factor x (g3) with the initial true score y (ly1)</td>
</tr>
<tr class="even">
<td align="left">sigma_j2lx1</td>
<td align="left">Covariance of change factor y (j2) with the initial true score x (lx1)</td>
</tr>
<tr class="odd">
<td align="left">sigma_j3lx1</td>
<td align="left">Covariance of change factor y (j3) with the initial true score x (lx1)</td>
</tr>
<tr class="even">
<td align="left">sigma_j2g2</td>
<td align="left">Covariance of change factors y (j2) and x (g2)</td>
</tr>
<tr class="odd">
<td align="left">sigma_j2g3</td>
<td align="left">Covariance of change factors y (j2) and x (g3)</td>
</tr>
<tr class="even">
<td align="left">sigma_j3g2</td>
<td align="left">Covariance of change factors y (j3) and x (g2)</td>
</tr>
<tr class="odd">
<td align="left">delta_con_xy</td>
<td align="left">Change score x (t) determined by true score y (t)</td>
</tr>
<tr class="even">
<td align="left">delta_con_yx</td>
<td align="left">Change score y (t) determined by true score x (t)</td>
</tr>
<tr class="odd">
<td align="left">delta_lag_xy</td>
<td align="left">Change score x (t) determined by true score y (t-1)</td>
</tr>
<tr class="even">
<td align="left">delta_lag_yx</td>
<td align="left">Change score y (t) determined by true score x (t-1)</td>
</tr>
<tr class="odd">
<td align="left">xi_con_xy</td>
<td align="left">Change score x (t) determined by change score y (t)</td>
</tr>
<tr class="even">
<td align="left">xi_con_yx</td>
<td align="left">Change score y (t) determined by change score x (t)</td>
</tr>
<tr class="odd">
<td align="left">xi_lag_xy</td>
<td align="left">Change score x (t) determined by change score y (t-1)</td>
</tr>
<tr class="even">
<td align="left">xi_lag_yx</td>
<td align="left">Change score y (t) determined by change score x (t-1)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/milanwiedemann/lcsm/issues">https://​github.com/​milanwiedemann/​lcsm/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing lcsm</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Milan Wiedemann <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1991-282X" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Mental Health Research UK <br><small class="roles"> Funder </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/milanwiedemann/lcsm"><img src="https://img.shields.io/badge/Last%20change-2020--02--17-brightgreen.svg" alt="last-change"></a></li>
<li><a href="https://travis-ci.org/milanwiedemann/lcsm"><img src="https://travis-ci.org/milanwiedemann/lcsm.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/milanwiedemann/lcsm"><img src="https://ci.appveyor.com/api/projects/status/swwgfqdufr5xmxf2?svg=true" alt="Build status"></a></li>
<li><a href="https://github.com/milanwiedemann/lcsm"><img src="https://img.shields.io/badge/Version-0.0.6-brightgreen.svg" alt="lcsm-version"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Milan Wiedemann, Mental Health Research UK.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
